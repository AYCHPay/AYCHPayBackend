{{ define "editPage" }}
<script>
	var serverTime;

	$('#send').bind('click', function () {

		$.get( 'ajax?controllerName=GetServerTime', function (data) {
			serverTime = data.time;
			$("#for-signature").val('{{.TxTypeId}},'+serverTime+',{{.CitizenId}},{{.StateId}},'+$("#page_name").val()+','+$("#page_value").val()+','+$("#page_menu").val()+','+$("#page_conditions").val());
			doSign();
			$("#send_to_net").trigger("click");
		}, "json" );
	} );


	$('#send_to_net').bind('click', function () {
		$.ajax({
			type: 'POST',
			url: 'ajax?controllerName=saveQueue',
			data: {
				'name' : $("#page_name").val(),
				'value' : $("#page_value").val(),
				'menu' : $("#page_menu").val(),
				'conditions' : $("#page_conditions").val(),
				'type' : '{{.TxType}}',
				'time' : serverTime,
				'citizenId' : '{{.CitizenId}}',
				'stateId' : '{{.StateId}}',
				'signature1': $('#signature1').val(),
				'signature2': $('#signature2').val(),
				'signature3': $('#signature3').val()
			},
			dataType: 'json',
			crossDomain: true,
			success: function(data) { send_to_net_success(data) },
			error: function(xhr, status, error) {
				Alert("Error", error, "error");
			}
		});
	} );
</script>
	<div class="content-heading">
		editPage
	</div>
	<ol class="breadcrumb">
	   <li><a href='#' onclick="load_page('interface')">Interface</a></li>
		<li class="active">{{if .DataPage.name}}Edit{{else}}New{{end}} page</li>
	</ol>


	<!-- START panel-->
	<div class="panel panel-default col-md-8">

	 <div class="panel-heading">
	 	<div class="panel-title">
			Page
		</div>
	 </div>
	 <div class="panel-body">

		 <div class="table-responsive">
			 <table class="table table-striped table-bordered table-hover">
				 <tbody>
				 <tr><td>Name<br>{{if .DataPage.name}} {{.DataPage.name}} <input type="hidden" id="page_name" value="{{.DataPage.name}}"> {{else}} <input type="text" id="page_name"> {{end}} </td></tr>
				 <tr><td>Value<br><textarea id="page_value" style="width: 100%; height: 500px">{{.DataPage.value}}</textarea></td></tr>
				 <tr><td>Menu<br>

					 <select id="page_menu">
					 {{range $data := .AllMenu }}
						 <option value="{{index $data "name"}}"
						 	{{if and $data $.DataPage.menu}}
								{{if eq (index $data "name") $.DataPage.menu}}
						 			selected
								{{end}}
						 	{{end}}
						 >
						 {{index $data "name"}}
						 </option>
					 {{end}}
					 </select>


				 </td></tr>
				 <tr><td>Conditions<br><textarea id="page_conditions">{{.DataPage.conditions}}</textarea></td></tr>
				 </tbody>
			 </table>
			 <button type="button" class="btn btn-primary" id="send" data-tool="panel-refresh" data-toggle="tooltip" data-spinner="standard" onClick="preloader(this);">Save</button>
		 </div>
	 </div>



	</div>

<div class="panel panel-default col-md-4">
	<div class="panel-heading">
		<div class="panel-title">
			Menu
		</div>
	</div>
	<div class="panel-body">

		<div class="table-responsive">
			<table class="table table-striped table-bordered table-hover">
				<tbody>
				<tr><td>Name<br>{{.DataMenu.name}}</td></tr>
				<tr><td>Value<br>{{.DataMenu.value}}</td></tr>
				<tr><td>Conditions<br>{{.DataMenu.conditions}}</td></tr>
				</tbody>
			</table>
		</div>
		<button type="button" class="btn btn-primary" onclick="load_page('editMenu', {name: {{.DataMenu.name}}} )">edit</button>

	</div>
</div>
	<!-- END panel-->



{{template "signatures".}}


{{end}}