{{ define "contracts" }}
<style>
	.textEditor {
		position:relative;
		font-size:0px;
		padding-bottom:5px;
	}
	.textEditor code  {
		position:relative;
		font: 14px "Monaco","Menlo","Ubuntu Mono","Consolas","source-code-pro",monospace;
		line-height:14px;
		z-index:1;
    }
	.textEditor section  {
		position:absolute;
		left:0px;
		top:0px;
		width:100%;
        height:100%;
		z-index:2;
    }
</style>

<script>
	var i = 0;
	
	$(".textEditor").each(function() {
		i += 1;
		$(this).find("section").attr("id", "textEditor_" + i);
		var editor = ace.edit($(this).find("section").attr("id"));
		var JavaScriptMode = ace.require("ace/mode/c_cpp").Mode;
		editor.setTheme("ace/theme/chrome");
		editor.session.setMode(new JavaScriptMode());
		editor.setShowPrintMargin(false);
		editor.getSession().setUseWrapMode(true);
		editor.renderer.setShowGutter(false);
		editor.setReadOnly(true);
	});
	
	$(".map").on('click', function(){
		$("#dl_modal").load("content?controllerHTML=modal_map", { }, function() {
			$("#modal_map").on('show.bs.modal', function(e) {
				initmap();
				clearMap();
				$("#toolchoice, #codechoice").change();
			})
		});
	});
	$(".avatar").on('click', function(){
		$("#dl_modal").load("content?controllerHTML=modal_avatar", { }, function() {
			$("#modal_avatar").modal("show");
		});
	});
</script>
	
	<div class="content-heading">
		contracts
	</div>
	<ol class="breadcrumb">
		{{if ne .Global "1"}}
			<li class="active">Smart contracts</li>
	   {{else}}
		   <li><a href="#" onclick="load_page('contracts')">Smart contracts</a></li>
		   <li class="active">Global</li>
	   {{end}}
	</ol>
	<!-- START panel-->
	<div class="panel panel-default">
	 <div class="panel-heading">
	 	<div class="panel-title">
			contracts
		</div>
	 </div>
	 <div class="panel-body">
		<div class="table-responsive">
		   <table class="table table-striped table-bordered table-hover">
			  <tbody>
			  <tr>
				  <td>id</td>
				  <td>Contract</td>
				  <td width="50">Action</td>
			  </tr>
			  {{ range $data := .StateSmartLaws }}
				 <tr>
					 <td class="thead"><strong>{{$data.id}}</strong></td>
					 <td><strong>{{$data.name}}</strong><br>
					 	<pre class="textEditor">
							<code>{{$data.value}}</code>
							<section>{{$data.value}}</section>
						</pre>
					 	<br>
						 <strong>Conditions for change</strong>
						 <pre class="textEditor">
							<code>{{$data.for}}</code>
							<section>{{$data.for}}</section>
						 </pre>
					 </td>
					 <td>
					 	<a type="button" class="btn btn-primary btn-block" onclick="load_page('editContract', {id: {{$data.id}} , global: {{$.Global}} } )"><i class="fa fa-cog"></i></a>
						<button type="button" class="map btn btn-primary btn-block"><i class="fa fa-map-marker"></i></button>
						<button type="button" class="avatar btn btn-primary btn-block"><i class="fa fa-file-image-o"></i></button>
					</td>
				 </tr>
			  {{end}}
			  </tbody>
		   </table>
		</div>
	 </div>
	 <div class="panel-footer">
	   <div class="clearfix">
		  <div class="pull-left">
			{{if ne .Global "1"}}
			<button type="button" class="btn btn-info" onclick="load_page('contracts', {global: 1})">Global</button>
			{{end}}
		  </div>
		  <div class="pull-right">
			 <button type="button" class="btn btn-primary" onclick="load_page('newContract')">Add new</button>
		  </div>
	   </div>
	  </div>
	</div>
	<!-- END panel-->
{{end}}