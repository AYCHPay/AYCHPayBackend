<script language="JavaScript" type="text/javascript">
	function SendTxOK{{.Unique}}() {
		preloader_hide();
        if (hist.length > hist_cur) {
            hist_go(hist[hist_cur]);
        }
	}
	var serverTime{{.Unique}};
	var predata{{.Unique}};
	function prepare_btncontract( contract, params ) {
		predata{{.Unique}} = {
			'TxName' : contract,
		};
        for (var prop in params) {
			predata{{$.Unique}}[prop] = params[prop];
        }
		$.get( 'ajax?json=ajax_prepare_tx', predata{{.Unique}},
			 function (data) {
				if (data.error.length > 0 ) {
					Alert("Error", data.error, "error");
				} else {
					console.log(data);
					predata{{.Unique}}.time = data.time;
					$("#for-signature{{.Unique}}").val(data.forsign);
					doSign({{.Unique}});
					predata{{.Unique}}.signature1 = $('#signature1{{.Unique}}').val();
					predata{{.Unique}}.signature2 = $('#signature2{{.Unique}}').val();
					predata{{.Unique}}.signature3 = $('#signature3{{.Unique}}').val();
					sendnet{{.Unique}}();
				}
		}, "json" );
	}

function sendnet{{.Unique}}() {
	predata{{.Unique}}['public'] = GKey.Public;
	$.ajax({
		type: 'POST',
		url: 'ajax?json=ajax_send_tx',
		data: predata{{.Unique}},
		dataType: 'json',
		crossDomain: true,
		success: function(result) {
			result.type_success = 'notification';
			send_to_net_success(result, SendTxOK{{.Unique}}, true );
		},
		error: function(xhr, status, error) {
			Alert("Error", error, "error");
		}
	});
}

function btn_contract(obj, contract, params, text) {
    console.log(contract, params, text);
    preloader(obj);    
    Alert(text, contract, "success:cancel", function(){
        prepare_btncontract( contract, params );
    });
}
</script>
{{template "signatures".}}